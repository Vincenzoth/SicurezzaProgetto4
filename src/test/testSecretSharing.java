package test;

import java.io.UnsupportedEncodingException;
import java.math.BigInteger;
import java.util.ArrayList;

import progetto4.*;

public class testSecretSharing {

	public static void main(String[] args) {
		int k = 1;
		int n= 4;

		SecretSharing ss = new SecretSharing();
		
		BigInteger mba= new BigInteger("212622312499986704349796832508408242891519795247899198578137738090531964853130818404366048638886171722263309476831178751161481505297952402810889915939607463207015954868610973378158926538128961045303804230501046669960295765553456030656772471360403568299550451142900264375011510655289554212342957222572504509936832422801125534981800671344493516114090346857810769951348147618817096703044532264743217468489561548975969461828941427157598566321829160449574189090442592669859561916747549227801155091249889582762336395786910653445828114034386450745833070268864050251850026448762189484717760504762826199659289314303632004628884553363588724263512150875637814776367277603724303977770777946572595347904738104876343068691572476673914163551561708902870471692819424103773046701361638420612846516689702590011883639654051127667201290918068181690646947217900875941997050550981308739440056020742112634589132928649088842184768812063601395957444390299043340631818883699114043212956052547274024631852901689939318027640455932259792923509872778449766284203233064450904833828976314854406803996682058045906890119766188118129653383603315400554445937094894028845611246460231699943355447342347188476042749098147766351763244863149366316");
		
		
		
		String text = null;
		text = new String(mba.toByteArray());
		byte[] byteText = text.getBytes();
		
		BigInteger secret = new BigInteger(byteText);
		ss.setSecret(secret);
		System.out.println("Segreto settato...  "  + secret);

		ArrayList<Entrant> informations = new ArrayList<Entrant>();
		BigInteger p = null;
		try {
			//p = ss.generatePartialInformations(k, n, informations);
			p = new BigInteger("398050578821470797684568948285362106066642177393353552271772625418671830904045430134761449074630602732247563644856778705984566323805826061900639314054192036589625987319880290317063483004841055167952591546475271197422337569833214018146530280077528549834375165388618791048841965571812922398822813760721935037546432760722689312372376081832984849290692049968073293651203182806785581671179175459957368675954561187496234276236087333748541382470182388911323573803632591532789863178215708576198085881420230313843250212829591545115412415571230316076700865484769838083430550224795935556614324733588470591717863533682425620814398945453843119931230664719713608519714361070840012949594104149350035142243828072313159663745723533741433641897248733686376043554290944928749745756511172901231520625702747601746368371315690756398114546599181646403734669235751994440945093058723793968544105423687765820669241146736719542546666283622730522164329385170960808831348113845761128491779981786710364842568312614433425257546833866763436418868997854407105069896136869887512286595031602903116266042562587594607165572679199831369047930527303494379819690349937318085072065489489498819598054461770110102851148499138706725000417281248821689");
			ss.generatePartialInformations(k, n, p,  informations);

			System.out.println("Informazioni parziali generate...");
			System.out.println("Il primo generato è: " + p);
			System.out.println(informations);
		} catch (SecretSharingException e) {
			System.err.println(e.getMessage());
		}


		ArrayList<Entrant> recInformations = new ArrayList<Entrant>();
		int i;
		for( i = 0; i < k; i++) {
			recInformations.add(informations.get(i));
		}

		BigInteger secret_r = ss.computeSecret(recInformations);
		System.out.println("Segreto ricostruito: " + secret_r);
		 
		System.out.println("------");
		byte[] rec_seq = secret_r.toByteArray();
		System.out.println(text);
		System.out.println(new String(rec_seq));
		
		
		System.out.println("------");
		System.out.println(new String(mba.toByteArray()));
		

	}

}
